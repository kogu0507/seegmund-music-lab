
---

## **📌 修正後の仕様書**

### **1. 概要**
本アプリは、ブラウザの `localStorage` を使用してメモを保存・読み込み・削除できるシンプルなメモ機能を提供する。データの長期保存は保証せず、一時的な学習メモとして利用することを目的とする。

---

### **2. 機能一覧**
✅ **メモの保存**
- `textarea` に入力されたメモを `localStorage` に保存。
- **一定時間（1秒）入力が停止すると自動保存**。
- `localStorage` に保存されたメモはページリロード後も復元される。
- **「メモをコピー」ボタンを追加し、メモの一括コピーが可能**。
- **プレビューエリア横にも「メモをコピー」ボタンを設置（`.easy-memo-copy` を使用）**。
- **文字数が制限（5MB相当）の 90% に達すると、警告メッセージを表示**。

✅ **メモの表示**
- **フッター、トップページ、章末のメモボタンには、`BootstrapIcons.js` を利用してアイコンを適用**。
- **「メモを編集」「メモをコピー」ボタンには、それぞれ鉛筆 (`pencil`) とクリップボード (`clipboard`) アイコンを適用**。
- **アイコンは `base.js` を通じて `prepend()` で追加され、HTMLに直接記述しない**。

---

### **3. UI 要素**
✅ **フッター内の要素**
- `button.open-memo-modal`：簡易メモ帳ボタン（アイコンは `base.js` により適用）。
- `div#easy-memo-modal`：メモ編集用のモーダル。

✅ **トップページの要素**
- `div#preview-area`：スクロール可能なプレビューエリア。
- `button.open-memo-modal`：「メモを編集」ボタン（`pencil` アイコンが `base.js` により適用）。
- `button.easy-memo-copy`：「メモをコピー」ボタン（`clipboard` アイコンが `base.js` により適用）。

✅ **学習コンテンツ内の要素**
- `p.memo-instruction`：「簡易メモに要点をまとめてみよう」という文言。
- `button.open-memo-modal`：モーダルを開くボタン（`pencil` アイコンが `base.js` により適用）。

---

### **4. 実装技術**
- **Bootstrap Icons は `BootstrapIcons.js` により動的に適用され、HTMLには直接記述しない**
- 言語：JavaScript (Vanilla JS)
- データ保存：`localStorage`
- UI 表示制御：DOM 操作
- **XSS 対策：`DOMPurify` を使用し、すべての `innerHTML` 更新時に適用**
- スタイリング：BootStrap を使用

---

### **5. イベントと処理フロー**
| イベント | 処理内容 |
|----------|----------|
| `DOMContentLoaded` | `localStorage` からメモを読み込み、`textarea` に復元、`preview-area` に表示 |
| `click` (`.open-memo-modal`) | メモ入力用モーダルを開く |
| `input` (`textarea`) | 1秒待機後に `localStorage` へ自動保存 |
| `click` (`.easy-memo-delete`) | 削除前に確認ダイアログを表示し、削除を確定すると `localStorage` からも削除 |
| `click` (`.easy-memo-copy`) | メモを一括コピーしてクリップボードに保存 |
| **文字数が制限（5MB相当）の 90% に達すると、警告メッセージを表示** |  |
| **`base.js` により `BootstrapIcons.js` を通じて各ボタンにアイコンを適用** | |

---

### **6. その他の考慮点**
- **`localStorage` の容量制限（約 5MB）に対する警告メッセージを表示**（文字数の90%超えで通知）。
- 削除時の確認ダイアログを追加。
- **「取り消し」機能は今後の拡張に含めるが、現時点では実装しない。**
- **「メモをコピー」ボタンのフィードバックとして、ボタンのテキストと色を変更（数秒後に元に戻す）。**

---

## **📌 未対応・テストが必要な項目（引き継ぎ）**
以下の項目はまだ対応・テストが完了していないため、引き継ぎ情報として整理します。

### **1. `#open-memo-modal` を削除した状態で問題なく動作するか**
✅ **現状：** `base.js` で `.open-memo-modal` クラスを使用しているため、`#open-memo-modal` は不要になる見込み。  
✅ **対応方法：**
1. **HTML から `#open-memo-modal` を削除**（クラス `.open-memo-modal` のみを使用）。
2. **動作確認：**  
   - メモ帳のボタン (`.open-memo-modal`) が正しく動作するかチェック。  
   - `base.js` での `querySelectorAll(".open-memo-modal")` が正常に動作しているか確認。
3. **問題がなければ仕様書を「クラスのみ」に確定し、修正完了。**

---

### **2. XSS対策（DOMPurify）の適用範囲の確認**
✅ **現状：**
- `innerHTML` の更新時には `DOMPurify.sanitize()` を適用済み。
- **`localStorage.setItem()` に適用漏れがあるか未確認。**

✅ **対応方法：**
1. **コード内の `localStorage.setItem("memo", content)` をチェック**
   - `DOMPurify.sanitize(content)` が適用されているか確認。
   - **適用漏れがある場合、修正が必要。**
2. **XSS攻撃のテスト**
   - メモに `<script>alert("XSS")</script>` などの悪意のあるコードを入力し、適切に無害化されるか確認。
3. **問題がなければ、仕様書の「XSS対策」の記述を最終確定。**

---

## **📌 次のステップ**
1️⃣ **仕様書の修正を反映（OKなら確定）**  
2️⃣ **未対応の2項目 (`#open-memo-modal の削除 & XSS対策`) の対応を引き継ぎ情報として整理**  
3️⃣ **`Bootstrap Icons` が正しく適用されない問題の調査（アイコン適用のテストと修正）**  

---







---

古い



2. #open-memo-modal を削除した状態で問題なく動作するか最終テスト
→ テストして問題なければ、仕様書の「クラスのみ」に確定する。

3. XSS対策（DOMPurify）の適用範囲の確認
→ localStorage.setItem() への適用漏れがないかチェックする。


# **メモアプリ仕様書（仮: 簡易メモ帳）**

## **1. 概要**
本アプリは、ブラウザの `localStorage` を使用してメモを保存・読み込み・削除できるシンプルなメモ機能を提供する。データの長期保存は保証せず、一時的な学習メモとして利用することを目的とする。

## **2. 機能一覧**
### ✅ **メモの保存**
- `textarea` に入力されたメモを `localStorage` に保存。
- **一定時間（1秒）入力が停止すると自動保存**。
- `localStorage` に保存されたメモはページリロード後も復元される。
- **「メモをコピー」ボタンを追加し、メモの一括コピーが可能**。
- **プレビューエリア横にも「メモをコピー」ボタンを設置（`.easy-memo-copy` を使用）**。
- **文字数が制限（5MB相当）の 90% に達すると、警告メッセージを表示**。

### ✅ **メモの表示（シンプルなUI）**
- **フッターに「簡易メモ帳」ボタンを配置**（ペンのアイコンは**検討中**）。
- **ボタンを押すとモーダルが開き、メモの入力とプレビューが可能**。
- **モーダルにはタブ（「入力」「プレビュー」「使い方」）を設置**。
- **トップページにプレビューエリアを追加し、スクロール可能に（仕様変更の可能性あり）**。
- **トップページに「メモを編集」ボタンを配置し、モーダルを開いて編集可能に**。
- **トップページのプレビューエリア横に「メモをコピー」ボタンを追加**。
- **各学習コンテンツの最後に「簡易メモに要点をまとめてみよう」という文言とモーダルボタンを設置（既に実装済み）**。

## **3. UI 要素**
### **フッター内の要素**
- `button.open-memo-modal`（**クラス指定に統一**）：（アイコン付きかどうかは**検討中**）。
- `div#easy-memo-modal`：メモ編集用のモーダル。

### **トップページの要素**（NEW: プレビューエリア＋編集ボタン＋コピー機能）
- `div#preview-area`：スクロール可能なプレビューエリア（仕様変更の可能性あり）。
- `button.open-memo-modal`：「メモを編集」ボタン（モーダルを開く）。
- `button.easy-memo-copy`：「メモをコピー」ボタン（**プレビューエリア横にも配置**）。

### **学習コンテンツ内の要素**（NEW: 章末メモ）
- `p.memo-instruction`：「簡易メモに要点をまとめてみよう」という文言。
- `button.open-memo-modal`（既存）：モーダルを開くボタン。

## **4. 実装技術**
- 言語：JavaScript (Vanilla JS)
- データ保存：`localStorage`
- UI 表示制御：DOM 操作
- **XSS 対策：`DOMPurify` を使用し、すべての `innerHTML` 更新時に適用**
- スタイリング：BootStrap を使用

## **5. イベントと処理フロー**
| イベント | 処理内容 |
|----------|----------|
| `DOMContentLoaded` | `localStorage` からメモを読み込み、`textarea` に復元、`preview-area` に表示 |
| `click` (`.open-memo-modal`) | メモ入力用モーダルを開く |
| `input` (`textarea`) | 1秒待機後に `localStorage` へ自動保存 |
| `click` (`.easy-memo-delete`) | 削除前に確認ダイアログを表示し、削除を確定すると `localStorage` からも削除 |
| `click` (`.easy-memo-copy`) | メモを一括コピーしてクリップボードに保存（モーダル内＆プレビューエリア横） |
| **文字数が制限（5MB相当）の 90% に達すると、警告メッセージを表示** |  |

## **6. その他の考慮点**
- **`localStorage` の容量制限（約 5MB）に対する警告メッセージを表示**（文字数の90%超えで通知）。
- 削除時の確認ダイアログを追加。
- **「取り消し」機能は今後の拡張に含めるが、現時点では実装しない。**
- モーダルの閉じるボタンや、タブ移動時にも **自動保存** を行う。
- **「メモをコピー」ボタンのフィードバックとして、ボタンのテキストと色を変更（数秒後に元に戻す）。**

---

## **修正したポイント**
1. **「#copy-memo-quick」→「.easy-memo-copy」に修正**（IDをクラスに統一）。
2. **「localStorage の容量制限警告を追加」** → **「文字数が90%を超えたら警告を表示」に修正**（コードはそのままでOK）。
3. **「簡易メモに要点をまとめてみよう」ボタンが既に設置済みなので、仕様書の表記を修正**。
4. **「open-memo-modal」の ID指定を削除し、クラス `.open-memo-modal` に統一（最終テスト後に確定）**。
5. **XSS対策：`DOMPurify` の適用範囲をすべての `innerHTML` 書き換え時に拡張する記述を追加**。

---

## **検討が必要な項目**
### **1. フッターの「簡易メモ帳」ボタンのアイコン**
**「✏️ 絵文字」 vs 「Bootstrap Icons（`<i class="bi bi-pencil"></i>`）」**  
→ **デザインの統一性を考慮して、Bootstrap Icons にするかどうかを決める**。

### **2. `#open-memo-modal` を削除した状態で問題なく動作するか最終テスト**
→ **テストして問題なければ、仕様書の「クラスのみ」に確定する。**

### **3. XSS対策（DOMPurify）の適用範囲の確認**
→ **`localStorage.setItem()` への適用漏れがないかチェックする。**

---


















---
---
以下古い

**メモアプリ仕様書（仮: 簡易メモ帳）**

### **1. 概要**
本アプリは、ブラウザの `localStorage` を使用してメモを保存・読み込み・削除できるシンプルなメモ機能を提供する。データの長期保存は保証せず、一時的な学習メモとして利用することを目的とする。

### **2. 機能一覧**
#### ✅ メモの保存
- `textarea` に入力されたメモを `localStorage` に保存。
- **一定時間（1秒）入力が停止すると自動保存**。
- `localStorage` に保存されたメモはページリロード後も復元される。
- **「メモをコピー」ボタンを追加し、メモの一括コピーが可能**。
- **localStorage の容量制限（約5MB）に近づいた場合、警告メッセージを表示**。

#### ✅ メモの表示（シンプルなUI）
- **フッターにペンのアイコン＋「簡易メモ帳」ボタンを配置**。
- **ボタンを押すとモーダルが開き、メモの入力とプレビューが可能**。
- **トップページにプレビューエリアを追加し、スクロール可能に（仕様変更の可能性あり）**。
- **トップページに「メモを編集」ボタンを配置し、モーダルを開いて編集可能に**。
- **トップページのプレビューエリア横に「メモをコピー」ボタンを追加**。
- **各学習コンテンツの最後に「簡易メモに要点をまとめてみよう」という文言とモーダルボタンを設置**。

### **3. UI 要素**
#### **フッター内の要素**
- `button#open-memo-modal`：ペンのアイコン＋「簡易メモ帳」ボタン。
- `div#memo-modal`：メモ編集用のモーダル。

#### **トップページの要素**（NEW: プレビューエリア＋編集ボタン＋コピー機能）
- `div#preview-area`：スクロール可能なプレビューエリア（仕様変更の可能性あり）。
- `button#edit-memo`：「メモを編集」ボタン（モーダルを開く）。
- `button#copy-memo`：「メモをコピー」ボタン（モーダル内に配置）。
- `button#copy-memo-quick`：「メモをコピー」ボタン（プレビューエリア横に配置）。

#### **学習コンテンツ内の要素**（NEW: 章末メモ）
- `p.memo-instruction`：「簡易メモに要点をまとめてみよう」という文言。
- `button#open-memo-modal`（既存）：モーダルを開くボタン。

### **4. 実装技術**
- 言語：JavaScript (Vanilla JS)
- データ保存：`localStorage`
- UI 表示制御：DOM 操作
- XSS 対策：**入力時のバリデーションを実施（ライブラリ導入は今後検討）**。
- スタイリング：BootStrap を使用

### **5. イベントと処理フロー**
| イベント | 処理内容 |
|----------|----------|
| `DOMContentLoaded` | `localStorage` からメモを読み込み、`textarea` に復元、`preview-area` に表示 |
| `click` (`#open-memo-modal`) | メモ入力用モーダルを開く |
| `input` (`textarea`) | 1秒待機後に `localStorage` へ自動保存 |
| `click` (`#clear-memo`) | 削除前に確認ダイアログを表示し、削除を確定すると `localStorage` からも削除 |
| `click` (`#edit-memo`) | モーダルを開き、メモを編集 |
| `click` (`#copy-memo`) | メモを一括コピーしてクリップボードに保存（モーダル内） |
| `click` (`#copy-memo-quick`) | メモを一括コピーしてクリップボードに保存（プレビューエリア横） |

### **6. その他の考慮点**
- `localStorage` の容量制限（約 5MB）に対する警告メッセージを追加。
- 削除時の確認ダイアログを追加。
- **「取り消し」機能は今後の拡張に含めるが、現時点では実装しない。**
- モーダルの閉じるボタンや、タブ移動時にも **自動保存** を行う。
- **「メモをコピー」ボタンのフィードバックとして、ボタンのテキストと色を変更（数秒後に元に戻す）。**

---

**今後の拡張（アイデア）**
- **ダッシュボード機能**：トップページで複数のメモを管理・一覧表示。
- **全画面入力モード**：大きな画面でメモを入力できるようにする。
- **学習進捗に応じたメモの整理**：学習コンテンツごとにメモを分類。
- **デザイン強化**：CSS でスタイルを調整。
- **クラウド保存機能**：サーバーと連携して、別のデバイスからもメモを利用可能にする。
- **削除後の「取り消し」機能の追加を検討**。
- **XSS対策のため、ライブラリ導入（例：DOMPurify）を今後検討**。

以上。



